"use strict";var i=require("node:module"),n=require("./resolve-ts-path-DPnQPtN7.cjs"),T=require("node:fs"),j=require("node:url");require("esbuild"),require("node:crypto"),require("./index-DTCJysGI.cjs");var u=require("./client-DjommMgI.cjs"),v=require("node:path");require("get-tsconfig");const p=[".cts",".mts",".ts",".tsx",".jsx"],E=[".js",".cjs",".mjs"],f=Object.assign(Object.create(null),i._extensions),F=f[".js"],_=(e,s)=>{u.parent?.send&&u.parent.send({type:"dependency",path:s});const r=p.some(c=>s.endsWith(c)),o=E.some(c=>s.endsWith(c));if(!r&&!o)return F(e,s);let t=T.readFileSync(s,"utf8");t=n.transformCjs(s,t,r),e._compile(t,s)};[".js",".ts",".tsx",".jsx"].forEach(e=>{f[e]=_}),Object.defineProperty(f,".mjs",{value:_,enumerable:!1});const P=`${v.sep}node_modules${v.sep}`,d=i._resolveFilename.bind(i),h=(e,s,r,o)=>{const t=n.resolveTsPath(e);if(s?.filename&&(n.tsExtensionsPattern.test(s.filename)||n.allowJs)&&t)for(const c of t)try{return d(c,s,r,o)}catch(l){const{code:a}=l;if(a!=="MODULE_NOT_FOUND"&&a!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw l}},x=(e,s,r,o)=>{const t=e.indexOf("?");if(t!==-1&&(e=e.slice(0,t)),e.startsWith(n.fileUrlPrefix)&&(e=j.fileURLToPath(e)),n.tsconfigPathsMatcher&&!n.isRelativePath(e)&&!s?.filename?.includes(P)){const l=n.tsconfigPathsMatcher(e);for(const a of l){const m=h(a,s,r,o);if(m)return m;try{return d(a,s,r,o)}catch{}}}const c=h(e,s,r,o);return c||d(e,s,r,o)},b=()=>{const{sourceMapsEnabled:e}=process,{_extensions:s,_resolveFilename:r}=i;return n.loadTsconfig(process.env.TSX_TSCONFIG_PATH),process.setSourceMapsEnabled(!0),i._extensions=f,i._resolveFilename=x,()=>{e===!1&&process.setSourceMapsEnabled(!1),i._extensions=s,i._resolveFilename=r}};exports.register=b,exports.resolveFilename=x;
