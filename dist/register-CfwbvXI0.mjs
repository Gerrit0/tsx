import a from"node:module";import{MessageChannel as c}from"node:worker_threads";const p=t=>{process,process.setSourceMapsEnabled(!0);const{port1:e,port2:o}=new c;return a.register(`./esm/index.mjs?${Date.now()}`,{parentURL:import.meta.url,data:{namespace:t?.namespace,port:o},transferList:[o]}),()=>(console.log("unregister!"),e.postMessage("deactivate"),new Promise(s=>{const n=r=>{console.log(3),console.log({message:r}),r==="deactivated"&&s()};e.on("message",n),e.unref()}))};export{p as r};
