import n from"node:module";import{MessageChannel as c}from"node:worker_threads";const p=r=>{process,process.setSourceMapsEnabled(!0);const{port1:e,port2:o}=new c;return n.register(`./esm/index.mjs?${Date.now()}`,{parentURL:import.meta.url,data:{namespace:r?.namespace,port:o},transferList:[o]}),()=>(console.log("unregister!"),e.postMessage("deactivate"),new Promise(s=>{const a=t=>{console.log(3),console.log({message:t}),t==="deactivated"&&s()};e.on("message",a)}))};export{p as r};
