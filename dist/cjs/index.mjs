import d from"module";import{p as y}from"../client-e7c60251.mjs";import S from"fs";import{parseTsconfig as x,getTsconfig as E,createFilesMatcher as F,createPathsMatcher as O}from"get-tsconfig";import{p as j,t as M,a as P}from"../index-b913f2b3.mjs";import{shouldApplySourceMap as h,inlineSourceMap as T}from"../source-map.mjs";import u from"path";import{i as g,r as b}from"../is-relative-path-pattern-ce88a5ac.mjs";import"net";import"../get-pipe-path-b74d9893.mjs";import"../temporary-directory-04b36185.mjs";import"os";import"url";import"esbuild";import"crypto";const A=r=>{if(r.includes("import")||r.includes("export"))try{return j(r)[3]}catch{return!0}return!1},N=/\.[cm]?tsx?$/,p=process.env.TSX_TSCONFIG_PATH?{path:u.resolve(process.env.TSX_TSCONFIG_PATH),config:x(process.env.TSX_TSCONFIG_PATH)}:E(),I=[".cts",".mts",".ts",".tsx",".jsx"],C=[".js",".cjs",".mjs"],_=p&&F(p),D=(r,m)=>{const n=r[".js"],o=(c,s)=>{m.send&&m.send({type:"dependency",path:s});const i=I.some(t=>s.endsWith(t)),a=C.some(t=>s.endsWith(t));if(!i&&!a)return n(c,s);let e=S.readFileSync(s,"utf8");if(s.endsWith(".cjs")){const t=M(s,e);t&&(e=h()?T(t):t.code)}else if(i||A(e)){const t=P(e,s,{tsconfigRaw:_==null?void 0:_(s)});e=h()?T(t):t.code}c._compile(e,s)};[".js",".ts",".tsx",".jsx"].forEach(c=>{r[c]=o}),Object.defineProperty(r,".mjs",{value:o,enumerable:!1})},G=`${u.sep}node_modules${u.sep}`,v=p&&O(p),H=r=>{const m=(n,o,c,s)=>{var i,a;const e=b(n);if(o!=null&&o.filename&&(N.test(o.filename)||(a=(i=p)==null?void 0:i.config.compilerOptions)!=null&&a.allowJs)&&e)for(const t of e)try{return r(t,o,c,s)}catch(l){const{code:f}=l;if(f!=="MODULE_NOT_FOUND"&&f!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw l}};return(n,o,c,s)=>{var i;const a=n.indexOf("?");if(a!==-1&&(n=n.slice(0,a)),v&&!g.test(n)&&!((i=o==null?void 0:o.filename)!=null&&i.includes(G))){const t=v(n);for(const l of t){const f=m(l,o,c,s);if(f)return f;try{return r(l,o,c,s)}catch{}}}const e=m(n,o,c,s);return e||r(n,o,c,s)}};process.setSourceMapsEnabled(!0),D(d._extensions,y),d._resolveFilename=H(d._resolveFilename.bind(d));
