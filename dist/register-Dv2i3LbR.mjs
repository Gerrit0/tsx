import n from"node:module";import{MessageChannel as p}from"node:worker_threads";const i=r=>{process,process.setSourceMapsEnabled(!0);const{port1:e,port2:t}=new p;return n.register(`./esm/index.mjs?${Date.now()}`,{parentURL:import.meta.url,data:{namespace:r?.namespace,port:t},transferList:[t]}),()=>(console.log("unregister!"),e.postMessage("deactivate"),new Promise(s=>{const o=a=>{a==="deactivated"&&s()};e.on("message",o)}))};export{i as r};
