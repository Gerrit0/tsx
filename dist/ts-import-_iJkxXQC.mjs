import{pathToFileURL as a}from"node:url";import p from"node:module";import{MessageChannel as i}from"node:worker_threads";const o=()=>{const{sourceMapsEnabled:s}=process;process.setSourceMapsEnabled(!0);const{port1:e,port2:t}=new i;return p.register(`./esm/index.mjs?${Date.now()}`,{parentURL:import.meta.url,data:{port:t},transferList:[t]}),()=>(e.postMessage("deactivate"),s===!1&&process.setSourceMapsEnabled(!1),new Promise(r=>{e.once("message",n=>{n==="deactivated"&&r()})}))};console.log(1);const c=(s,e)=>{if(!e)throw new Error("The current file path (import.meta.url) must be provided in the second argument of tsImport()");const t=e.startsWith("file://")?e:a(e),r=new URL(s,t);return r.searchParams.set("tsx.tsImport",""),r.toString()},l=(s,e)=>{const t=c(s,e),r=o();return import(t).finally(()=>r())};export{o as r,l as t};
