import n from"node:module";import{MessageChannel as c}from"node:worker_threads";const p=()=>{const{sourceMapsEnabled:a}=process;process.setSourceMapsEnabled(!0);const{port1:s,port2:t}=new c,e={port:t,a:0};return setInterval(()=>{e.a++,console.log(e)},1),n.register(`./esm/index.mjs?${Date.now()}`,{parentURL:import.meta.url,data:e,transferList:[t]}),async()=>{s.postMessage("deactivate"),await new Promise(r=>{s.once("message",o=>{o==="deactivated"&&r()})}),a===!1&&process.setSourceMapsEnabled(!1)}};export{p as r};
