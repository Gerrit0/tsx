import a from"node:module";import{MessageChannel as c}from"node:worker_threads";const p=s=>{process,process.setSourceMapsEnabled(!0);const{port1:e,port2:t}=new c;return a.register(`./esm/index.mjs?${Date.now()}`,{parentURL:import.meta.url,data:{namespace:s?.namespace,port:t},transferList:[t]}),()=>(console.log("unregister!"),e.postMessage("deactivate"),new Promise(o=>{o();const n=r=>{console.log(3),console.log({message:r}),r==="deactivated"&&o()};e.on("message",n),e.unref()}))};export{p as r};
