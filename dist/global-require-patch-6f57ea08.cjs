"use strict";var c=require("module"),E=require("fs"),f=require("get-tsconfig"),p=require("./index-971a6964.cjs"),v=require("./source-map.cjs"),h=require("./client-fc143b89.cjs"),_=require("path"),x=require("./is-relative-path-pattern-d3bd85cb.cjs");const O=s=>{if(s.includes("import")||s.includes("export"))try{return p.parseEsm(s)[3]}catch{return!0}return!1},P=/\.[cm]?tsx?$/,u=process.env.TSX_TSCONFIG_PATH?{path:_.resolve(process.env.TSX_TSCONFIG_PATH),config:f.parseTsconfig(process.env.TSX_TSCONFIG_PATH)}:f.getTsconfig(),b=[".cts",".mts",".ts",".tsx",".jsx"],j=[".js",".cjs",".mjs"],S=u&&f.createFilesMatcher(u),d={...c._extensions},A=d[".js"],y=(s,e)=>{var t;(t=h.parent)!=null&&t.send&&h.parent.send({type:"dependency",path:e});const o=b.some(n=>e.endsWith(n)),i=j.some(n=>e.endsWith(n));if(!o&&!i)return A(s,e);let r=E.readFileSync(e,"utf8");if(e.endsWith(".cjs")){const n=p.transformDynamicImport(e,r);n&&(r=v.shouldApplySourceMap()?v.inlineSourceMap(n):n.code)}else if(o||O(r)){const n=p.transformSync(r,e,{tsconfigRaw:S==null?void 0:S(e)});r=v.shouldApplySourceMap()?v.inlineSourceMap(n):n.code}s._compile(r,e)};[".js",".ts",".tsx",".jsx"].forEach(s=>{d[s]=y}),Object.defineProperty(d,".mjs",{value:y,enumerable:!1});const R=`${_.sep}node_modules${_.sep}`,F=u&&f.createPathsMatcher(u),T=c._resolveFilename.bind(c),M=(s,e,t,o)=>{var i,r;const n=x.resolveTsPath(s);if(e!=null&&e.filename&&(P.test(e.filename)||(r=(i=u)==null?void 0:i.config.compilerOptions)!=null&&r.allowJs)&&n)for(const m of n)try{return T(m,e,t,o)}catch(a){const{code:l}=a;if(l!=="MODULE_NOT_FOUND"&&l!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw a}},g=(s,e,t,o)=>{var i;const r=s.indexOf("?");if(r!==-1&&(s=s.slice(0,r)),F&&!x.isRelativePathPattern.test(s)&&!((i=e==null?void 0:e.filename)!=null&&i.includes(R))){const m=F(s);for(const a of m){const l=M(a,e,t,o);if(l)return l;try{return T(a,e,t,o)}catch{}}}const n=M(s,e,t,o);return n||T(s,e,t,o)},{_extensions:N,_resolveFilename:I}=c,C=process.sourceMapsEnabled,D=()=>{process.setSourceMapsEnabled(!0),c._extensions=d,c._resolveFilename=g},G=()=>{C===!1&&process.setSourceMapsEnabled(!1),c._extensions=N,c._resolveFilename=I};exports.extensions=d,exports.register=D,exports.resolveFilename=g,exports.unregister=G;
